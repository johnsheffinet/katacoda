# Deploy Containers Using Kubectl

# Step 1 - Launch Cluster
minikube version

minikube start

kubectl version --short

kubectl cluster-info

kubectl get cs

kubectl describe cs/scheduler

kubectl get no

kubectl describe no/minikube

export EXTERNAL_IP=$(minikube ip)

echo $EXTERNAL_IP

# Step 2 - Create Deploy
kubectl create deploy http \
--image=katacoda/docker-http-server:latest

kubectl get deploy

kubectl describe deploy http

kubectl get po

export POD_NAME =$(kubectl get po -o go-template='{{range .items}}{{.metadata.name}}{{"\n"}}{{end}}')

echo $POD_NAME

kubectl describe po $POD_NAME

curl http://$EXTERNAL_IP:8000

# Step 3 - Expose Deploy
kubectl expose deploy http \
--external-ip=$EXTERNAL_IP \
--port=8000 \
--target-port=80

kubectl get svc

kubectl describe svc http

curl http://$EXTERNAL_IP:8000

# Step 4 - Scale Deploy
kubectl scale deploy http \
--replicas=3

kubectl get deploy

curl http://$EXTERNAL_IP:8000

# Step 5 - Create, Expose & Scale Deploy
kubectl create deploy http1 \
--image=katacoda\docker-http-server:latest
--expose \
--external-ip=$EXTERNAL_IP \
--port=8080 \
--target-port=80
--replicas=3

kubectl get deploy,po,svc

curl http://$EXTERNAL_IP:8080
